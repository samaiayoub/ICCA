import React from "react";

export default function ChessTournamentTree() {
  const WIDTH = 1100;
  const HEIGHT = 720;
  const PADDING_X = 80;
  const BOX_W = 160;
  const BOX_H = 44;

  const leftRound1 = [
    "ShadowRook99",
    "KnightStorm",
    "PawnSlayer",
    "BishopBlitz",
    "EndgameMaster",
    "CheckmatePro",
    "RookRunner",
    "FileCrusher",
  ];

  const rightRound1 = [
    "QueenHunt3r",
    "CastlingKing",
    "GambitGuru",
    "MateInTwo",
    "BlitzWizard",
    "ForkFinder",
    "samaiayoub0 (2060)",
    "RandomOpponent (2502)",
  ];

  const placeholder4 = Array(4).fill("");
  const placeholder2 = Array(2).fill("");

  const columns = [
    leftRound1,
    placeholder4,
    placeholder2,
    [""],
    placeholder2,
    placeholder4,
    rightRound1,
  ];

  const colCount = columns.length;
  const colGap = (WIDTH - PADDING_X * 2) / (colCount - 1);

  const positions = columns.map((col, colIdx) => {
    const n = col.length;
    const verticalGap = HEIGHT / n;
    return col.map((value, idx) => {
      const x = PADDING_X + colIdx * colGap;
      const y = verticalGap * (idx + 0.5);
      return { x, y, label: value, colIdx, idx };
    });
  });

  const lines = [];
  for (let c = 0; c <= 2; c++) {
    const children = positions[c];
    const parents = positions[c + 1];
    children.forEach((child, i) => {
      const pIdx = Math.floor(i / 2);
      const parent = parents[pIdx];
      const midX = (child.x + parent.x) / 2;
      lines.push({ x1: child.x + BOX_W / 2, y1: child.y, x2: midX, y2: child.y });
      lines.push({ x1: midX, y1: child.y, x2: midX, y2: parent.y });
      lines.push({ x1: midX, y1: parent.y, x2: parent.x - BOX_W / 2, y2: parent.y });
    });
  }
  for (let c = 6; c >= 4; c--) {
    const children = positions[c];
    const parents = positions[c - 1];
    children.forEach((child, i) => {
      const pIdx = Math.floor(i / 2);
      const parent = parents[pIdx];
      const midX = (child.x + parent.x) / 2;
      lines.push({ x1: child.x - BOX_W / 2, y1: child.y, x2: midX, y2: child.y });
      lines.push({ x1: midX, y1: child.y, x2: midX, y2: parent.y });
      lines.push({ x1: midX, y1: parent.y, x2: parent.x + BOX_W / 2, y2: parent.y });
    });
  }

  const isLiveLabel = (label) =>
    label.includes("samaiayoub0") || label.includes("RandomOpponent");

  const bg = "#071233";
  const boxBlue = "#09284a";
  const liveRed = "#c92b2b";
  const lineColor = "#0e2a44";

  return (
    <div style={{ background: `linear-gradient(180deg, ${bg} 0%, #041a2f 100%)`, minHeight: "100vh", padding: 24, color: "#fff", fontFamily: 'Inter, system-ui' }}>
      <h1 style={{ textAlign: "center", fontSize: 32, marginBottom: 4, fontWeight: 800 }}>Grandmaster Invitational 2025</h1>
      <p style={{ textAlign: "center", fontSize: 14, marginBottom: 20, opacity: 0.8 }}>16 Players | Single Elimination | Live Finals</p>

      <div style={{ position: "relative", width: WIDTH, height: HEIGHT, margin: "0 auto" }}>
        <svg width={WIDTH} height={HEIGHT} style={{ position: "absolute", left: 0, top: 0, pointerEvents: "none" }}>
          {lines.map((seg, i) => (
            <line key={i} x1={seg.x1} y1={seg.y1} x2={seg.x2} y2={seg.y2} stroke={lineColor} strokeWidth={2} />
          ))}
        </svg>

        {positions.map((col, colIdx) => (
          <React.Fragment key={colIdx}>
            {col.map((cell, i) => {
              const left = cell.x - BOX_W / 2;
              const top = cell.y - BOX_H / 2;
              const live = isLiveLabel(cell.label);
              return (
                <div key={i} style={{ position: "absolute", left, top, width: BOX_W, height: BOX_H, display: "flex", alignItems: "center", justifyContent: "center", borderRadius: 8, background: live ? liveRed : boxBlue, border: live ? "2px solid gold" : "1px solid rgba(255,255,255,0.1)", fontSize: 13, fontWeight: 600, boxShadow: live ? "0 0 20px rgba(255,215,0,0.7)" : "0 4px 10px rgba(0,0,0,0.4)" }}>
                  {live && <span style={{ marginRight: 6, color: "gold" }}>‚óè</span>}
                  {cell.label}
                </div>
              );
            })}
          </React.Fragment>
        ))}

        <div style={{ position: "absolute", left: PADDING_X + 3 * colGap - 60, top: HEIGHT / 2 - 50 }}>
          <div style={{ width: 140, height: 100, borderRadius: 12, background: "#0a2540", display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", fontWeight: 800, fontSize: 18, color: "gold", boxShadow: "0 0 25px rgba(255,215,0,0.6)" }}>
            FINAL
            <span style={{ fontSize: 12, marginTop: 4, color: "#fff" }}>Best of 1</span>
          </div>
        </div>
      </div>
    </div>
  );
}
